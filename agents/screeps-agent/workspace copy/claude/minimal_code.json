{
  "branch": "default",
  "modules": {
    "main": "// CLAUDE PvP STRATEGY\nconst ROLES = {\n  HARVESTER: 'harvester',\n  BUILDER: 'builder',\n  UPGRADER: 'upgrader',\n  GUARD: 'guard',\n  ATTACKER: 'attacker'\n};\n\nfunction getBodyParts(role, energy) {\n  const bodies = {\n    [ROLES.HARVESTER]: [WORK, CARRY, MOVE],\n    [ROLES.BUILDER]: [WORK, CARRY, MOVE],\n    [ROLES.UPGRADER]: [WORK, CARRY, MOVE],\n    [ROLES.GUARD]: [TOUGH, ATTACK, MOVE],\n    [ROLES.ATTACKER]: [ATTACK, MOVE]\n  };\n  return bodies[role] || bodies[ROLES.HARVESTER];\n}\n\nfunction manageSpawns() {\n  for (const spawnName in Game.spawns) {\n    const spawn = Game.spawns[spawnName];\n    if (spawn.spawning) continue;\n    \n    const room = spawn.room;\n    const creeps = room.find(FIND_MY_CREEPS);\n    const enemies = room.find(FIND_HOSTILE_CREEPS);\n    \n    // Emergency defense\n    if (enemies.length > 0) {\n      const body = getBodyParts(ROLES.GUARD, room.energyAvailable);\n      spawn.spawnCreep(body, `guard_${Game.time}`, {memory: {role: ROLES.GUARD}});\n      continue;\n    }\n    \n    // Basic economy\n    const harvesters = creeps.filter(c => c.memory.role === ROLES.HARVESTER);\n    if (harvesters.length < 3) {\n      const body = getBodyParts(ROLES.HARVESTER, room.energyAvailable);\n      spawn.spawnCreep(body, `harvester_${Game.time}`, {memory: {role: ROLES.HARVESTER}});\n      continue;\n    }\n    \n    const builders = creeps.filter(c => c.memory.role === ROLES.BUILDER);\n    if (builders.length < 2) {\n      const body = getBodyParts(ROLES.BUILDER, room.energyAvailable);\n      spawn.spawnCreep(body, `builder_${Game.time}`, {memory: {role: ROLES.BUILDER}});\n      continue;\n    }\n  }\n}\n\nfunction runHarvester(creep) {\n  if (creep.store.getFreeCapacity() === 0) {\n    const target = creep.pos.findClosestByPath(FIND_STRUCTURES, {\n      filter: s => (s.structureType === STRUCTURE_SPAWN || s.structureType === STRUCTURE_EXTENSION) &&\n                   s.store.getFreeCapacity(RESOURCE_ENERGY) > 0\n    });\n    if (target && creep.transfer(target, RESOURCE_ENERGY) === ERR_NOT_IN_RANGE) {\n      creep.moveTo(target);\n    }\n  } else {\n    const source = creep.pos.findClosestByPath(FIND_SOURCES_ACTIVE);\n    if (source && creep.harvest(source) === ERR_NOT_IN_RANGE) {\n      creep.moveTo(source);\n    }\n  }\n}\n\nfunction runGuard(creep) {\n  const enemies = creep.room.find(FIND_HOSTILE_CREEPS);\n  if (enemies.length > 0) {\n    const target = creep.pos.findClosestByPath(enemies);\n    if (target && creep.attack(target) === ERR_NOT_IN_RANGE) {\n      creep.moveTo(target);\n    }\n  }\n}\n\nfunction runBuilder(creep) {\n  if (creep.store.getUsedCapacity() === 0) {\n    const source = creep.pos.findClosestByPath(FIND_SOURCES_ACTIVE);\n    if (source && creep.harvest(source) === ERR_NOT_IN_RANGE) {\n      creep.moveTo(source);\n    }\n  } else {\n    const target = creep.pos.findClosestByPath(FIND_CONSTRUCTION_SITES);\n    if (target && creep.build(target) === ERR_NOT_IN_RANGE) {\n      creep.moveTo(target);\n    }\n  }\n}\n\nmodule.exports.loop = function () {\n  // Clear memory\n  for (const name in Memory.creeps) {\n    if (!Game.creeps[name]) delete Memory.creeps[name]; }\n  \n  manageSpawns();\n  \n  // Run creeps\n  for (const name in Game.creeps) {\n    const creep = Game.creeps[name];\n    switch (creep.memory.role) {\n      case ROLES.HARVESTER:\n        runHarvester(creep);\n        break;\n      case ROLES.GUARD:\n        runGuard(creep);\n        break;\n      case ROLES.BUILDER:\n        runBuilder(creep);\n        break;\n      case ROLES.UPGRADER:\n        if (creep.store.getUsedCapacity() === 0) {\n          const source = creep.pos.findClosestByPath(FIND_SOURCES_ACTIVE);\n          if (source && creep.harvest(source) === ERR_NOT_IN_RANGE) creep.moveTo(source);\n        } else {\n          if (creep.upgradeController(creep.room.controller) === ERR_NOT_IN_RANGE) creep.moveTo(creep.room.controller);\n        }\n        break;\n    }\n  }\n  \n  // Tower defense\n  const towers = Game.rooms.W5N5.find(FIND_MY_STRUCTURES, {\n    filter: s => s.structureType === STRUCTURE_TOWER\n  });\n  for (const tower of towers) {\n    const enemy = tower.pos.findClosestByRange(FIND_HOSTILE_CREEPS);\n    if (enemy) tower.attack(enemy);\n  }\n};"
  }
}